(function () {
    'use strict';
    angular.module('myShopApp', ["ui.router", "ngAnimate", "oc.lazyLoad"]);
}());

(function () {
    'use strict';

    angular.module('myShopApp')
        .config(['$httpProvider', '$stateProvider', '$urlRouterProvider', '$urlMatcherFactoryProvider', AppRoutesConfiguration]);

    function AppRoutesConfiguration($httpProvider, $stateProvider, $urlRouterProvider, $urlMatcherFactoryProvider) {
        let commonScripts = [];
        $urlMatcherFactoryProvider.caseInsensitive(true);
        $stateProvider
            .state('main', {
                url: "/main",
                views: {
                    '': {
                        templateUrl: "main/main.html"
                    },
                    'navigation@main': {
                        templateUrl: "main/navigation.html",
                        controller: "NavigationController",
                        controllerAs: "vm"
                    }
                }
            })
            .state('main.dashboard', {
                url: "/Dashboard",
                views: {
                    '@main': {
                        templateUrl: "dashboard/dashboard.html",
                        controller: "DashboardController",
                        controllerAs: "vm"
                    }
                },
                resolve: {
                    loadJS: ["$ocLazyLoad", function ($ocLazyLoad) {
                        return $ocLazyLoad.load([
                            "dashboard/dashboard.controller.js"
                        ]);
                    }]
                }
            })
            .state('main.customers', {
                url: "/Customers",
                views: {
                    '@main': {
                        templateUrl: "customer/customers.html",
                        controller: "DashboardCustomerController",
                        controllerAs: "vm"
                    }
                },
                resolve: {
                    loadJS: ["$ocLazyLoad", function ($ocLazyLoad) {
                        return $ocLazyLoad.load([
                            "customer/customers.controller.js"
                        ]);
                    }]
                }
            })
            .state('main.customers.add', {
                url: "/Add",
                templateUrl: "customer/customers.add.html",
                controller: "AddCustomerController",
                controllerAs: "customer",
                resolve: {
                    loadJS: ["$ocLazyLoad", function ($ocLazyLoad) {
                        return $ocLazyLoad.load([
                            "customer/customers.add.controller.js"
                        ]);
                    }]
                }
            })
            .state('main.customers.list', {
                url: "/List",
                templateUrl: "customer/customers.list.html",
                controller: "ListCustomerController",
                controllerAs: "customerList",
                resolve: {
                    loadJS: ["$ocLazyLoad", function ($ocLazyLoad) {
                        return $ocLazyLoad.load(commonScripts.concat([
                            "customer/customers.list.controller.js"
                        ]));
                    }]
                }
            })
            .state('main.products', {
                url: "/Products",
                views: {
                    '@main': {
                        templateUrl: "products.html",
                        controller: "DashboardProductController",
                        controllerAs: "vm"
                    }
                },
                resolve: {
                    loadJS: ["$ocLazyLoad", function ($ocLazyLoad) {
                        $ocLazyLoad.load(commonScripts.concat(["/bundle/js/products.min.js"]));
                    }]
                }
            })
            .state('main.products.add', {
                url: "/Add",
                templateUrl: "products.add.html",
                controller: "AddProductController",
                controllerAs: "vm",
                resolve: {
                    loadJS: ["$ocLazyLoad", function ($ocLazyLoad) {
                        return $ocLazyLoad.load(commonScripts.concat(["/bundle/js/products.min.js"]));
                    }]
                }
            })
            .state('main.products.edit', {
                url: "/Edit/:productId",
                templateUrl: "products.edit.html",
                controller: "ProductEditController",
                controllerAs: "vm",
                resolve: {
                    loadJS: ["$ocLazyLoad", function ($ocLazyLoad) {
                        return $ocLazyLoad.load(commonScripts.concat(["/bundle/js/products.min.js"]));
                    }],
                    productItem: ["dataAccessService", "$stateParams", function (dataAccessService, $stateParams) {
                        return dataAccessService.fetch("/api/get/single/product/" + $stateParams.productId)
                            .then(function (product) {
                                return product;
                            });
                    }]
                }
            })
            .state('main.products.list', {
                url: "/List",
                templateUrl: "products.list.html",
                controller: "ProductListController",
                controllerAs: "vm",
                resolve: {
                    loadJS: ["$ocLazyLoad", function ($ocLazyLoad) {
                        return $ocLazyLoad.load(commonScripts.concat(["bundle/js/products.min.js"]));
                    }]
                }
            })
            // .state('main.purchases', {
            //     url: "/Purchases",
            //     templateUrl: "customer/dashboard-customer.html"
            // })
            // .state('main.sales', {
            //     url: "/sales",
            //     templateUrl: "customer/dashboard-customer.html"
            // });
            .state('login', {
                url: "/login",
                templateUrl: "login/login.html",
                resolve: {
                    loadJS: ["$ocLazyLoad", function ($ocLazyLoad) {
                        return $ocLazyLoad.load([
                            "login/login.controller.js"
                        ]);
                    }]
                }
            })
        $urlRouterProvider.otherwise('/main/dashboard');
        $httpProvider.interceptors.push('APIInterceptorService');
    }
}());

(function () {
    'use strict';

    angular
        .module('myShopApp')
        .service('APIInterceptorService', APIInterceptorService);

    APIInterceptorService.$inject = [];

    function APIInterceptorService() {
        this.request = request;
        this.response = response;
        this.requestError = requestError;
        this.responseError = responseError;

        ////////////////

        function request(config) {
            //TODO : Auth service to get authorization
            return config;
        }

        function response(config) {
            return config;
        }

        function requestError(response) {
            return response;
        }

        function responseError(response) {
            
            return response;
        }
    }
}());

(function () {
    'use strict';

    angular
        .module('myShopApp')
        .service('dataAccessService', DataAccessService);

    DataAccessService.$inject = ["$http", "$q"];

    function DataAccessService($http, $q) {
        this.fetch = get;
        this.feed = post;
        this.update = put;
        this.remove = remove;
        ////////////////
        var deferer;

        function error(error) {
            deferer.reject(error);
            console.error("In Data-Service Error-Callback :",error);            
        }

        function success(response) {
            deferer.resolve(response.data);
            console.info("In Data-Service Success-Callback :",response);
        }

        function get(url) {
            deferer = $q.defer();
            $http.get(url,{cache:false}).then(success, error);
            return deferer.promise;
        }

        function post(url,data) {
            deferer = $q.defer();
            $http.post(url,{payLoad:data}).then(success,error);
            return deferer.promise;
        }

        function put() {}

        function remove() {}
    }
}());

(function () {
    'use strict';

    angular
        .module('myShopApp')
        .controller('NavigationController', NavigationController);

    NavigationController.inject = ['$rootScope', '$location'];

    function NavigationController($rootScope, $location) {
        var vm = this;
        activate();

        function activate() {
            selectCurrentSideMenu();
        }

        function selectCurrentSideMenu() {
            vm.selectedSideMenu = $location.$$path.split('/')[2].toLowerCase();
        }
        // $rootScope.$on('$stateChangeStart',
        //     function (event, toState, toParams, fromState, fromParams, options) {
        //         vm.selectedSideMenu = $location.$$path.split('/')[2];
        //     });
        $rootScope.$on('$stateChangeSuccess',
            function (event, toState, toParams, fromState, fromParams, options) {
                selectCurrentSideMenu();
            });
    }
}());

angular.module('myShopApp').run(['$templateCache', function($templateCache) {
  'use strict';

  $templateCache.put('app/front-end/main/main.html',
    "<div id=\"wrapper\"><!-- Navigation --><nav class=\"navbar navbar-inverse navbar-fixed-top\" role=\"navigation\" ui-view=\"navigation\"></nav><div id=\"page-wrapper\"><div class=\"container-fluid\" ui-view=\"\"></div></div><!-- /#page-wrapper --></div>"
  );


  $templateCache.put('app/front-end/main/navigation.html',
    "<!-- Brand and toggle get grouped for better mobile display --><div><div class=\"navbar-header\"><button type=\"button\" class=\"navbar-toggle\" ng-init=\"vm.navCollapse=true;\" ng-click=\"vm.navCollapse=!vm.navCollapse\"><span class=\"sr-only\">Toggle navigation</span> <span class=\"icon-bar\"></span> <span class=\"icon-bar\"></span> <span class=\"icon-bar\"></span></button> <a class=\"navbar-brand\" href=\"/\">My Shop</a></div><!-- Top Menu Items --><!--<ul class=\"nav navbar-right top-nav\">\r" +
    "\n" +
    "        <li class=\"dropdown\">\r" +
    "\n" +
    "            <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\"><i class=\"fa fa-envelope\"></i> <b class=\"caret\"></b></a>\r" +
    "\n" +
    "            <ul class=\"dropdown-menu message-dropdown\">\r" +
    "\n" +
    "                <li class=\"message-preview\">\r" +
    "\n" +
    "                    <a href=\"#\">\r" +
    "\n" +
    "                        <div class=\"media\">\r" +
    "\n" +
    "                            <span class=\"pull-left\">\r" +
    "\n" +
    "                                        <img class=\"media-object\" src=\"http://placehold.it/50x50\" alt=\"\">\r" +
    "\n" +
    "                                    </span>\r" +
    "\n" +
    "                            <div class=\"media-body\">\r" +
    "\n" +
    "                                <h5 class=\"media-heading\"><strong>John Smith</strong>\r" +
    "\n" +
    "                                </h5>\r" +
    "\n" +
    "                                <p class=\"small text-muted\"><i class=\"fa fa-clock-o\"></i> Yesterday at 4:32 PM</p>\r" +
    "\n" +
    "                                <p>Lorem ipsum dolor sit amet, consectetur...</p>\r" +
    "\n" +
    "                            </div>\r" +
    "\n" +
    "                        </div>\r" +
    "\n" +
    "                    </a>\r" +
    "\n" +
    "                </li>\r" +
    "\n" +
    "                <li class=\"message-preview\">\r" +
    "\n" +
    "                    <a href=\"#\">\r" +
    "\n" +
    "                        <div class=\"media\">\r" +
    "\n" +
    "                            <span class=\"pull-left\">\r" +
    "\n" +
    "                                        <img class=\"media-object\" src=\"http://placehold.it/50x50\" alt=\"\">\r" +
    "\n" +
    "                                    </span>\r" +
    "\n" +
    "                            <div class=\"media-body\">\r" +
    "\n" +
    "                                <h5 class=\"media-heading\"><strong>John Smith</strong>\r" +
    "\n" +
    "                                </h5>\r" +
    "\n" +
    "                                <p class=\"small text-muted\"><i class=\"fa fa-clock-o\"></i> Yesterday at 4:32 PM</p>\r" +
    "\n" +
    "                                <p>Lorem ipsum dolor sit amet, consectetur...</p>\r" +
    "\n" +
    "                            </div>\r" +
    "\n" +
    "                        </div>\r" +
    "\n" +
    "                    </a>\r" +
    "\n" +
    "                </li>\r" +
    "\n" +
    "                <li class=\"message-preview\">\r" +
    "\n" +
    "                    <a href=\"#\">\r" +
    "\n" +
    "                        <div class=\"media\">\r" +
    "\n" +
    "                            <span class=\"pull-left\">\r" +
    "\n" +
    "                                        <img class=\"media-object\" src=\"http://placehold.it/50x50\" alt=\"\">\r" +
    "\n" +
    "                                    </span>\r" +
    "\n" +
    "                            <div class=\"media-body\">\r" +
    "\n" +
    "                                <h5 class=\"media-heading\"><strong>John Smith</strong>\r" +
    "\n" +
    "                                </h5>\r" +
    "\n" +
    "                                <p class=\"small text-muted\"><i class=\"fa fa-clock-o\"></i> Yesterday at 4:32 PM</p>\r" +
    "\n" +
    "                                <p>Lorem ipsum dolor sit amet, consectetur...</p>\r" +
    "\n" +
    "                            </div>\r" +
    "\n" +
    "                        </div>\r" +
    "\n" +
    "                    </a>\r" +
    "\n" +
    "                </li>\r" +
    "\n" +
    "                <li class=\"message-footer\">\r" +
    "\n" +
    "                    <a href=\"#\">Read All New Messages</a>\r" +
    "\n" +
    "                </li>\r" +
    "\n" +
    "            </ul>\r" +
    "\n" +
    "        </li>\r" +
    "\n" +
    "        <li class=\"dropdown\">\r" +
    "\n" +
    "            <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\"><i class=\"fa fa-user\"></i> John Smith <b class=\"caret\"></b></a>\r" +
    "\n" +
    "            <ul class=\"dropdown-menu\">\r" +
    "\n" +
    "                <li>\r" +
    "\n" +
    "                    <a href=\"#\"><i class=\"fa fa-fw fa-user\"></i> Profile</a>\r" +
    "\n" +
    "                </li>\r" +
    "\n" +
    "                <li>\r" +
    "\n" +
    "                    <a href=\"#\"><i class=\"fa fa-fw fa-envelope\"></i> Inbox</a>\r" +
    "\n" +
    "                </li>\r" +
    "\n" +
    "                <li>\r" +
    "\n" +
    "                    <a href=\"#\"><i class=\"fa fa-fw fa-gear\"></i> Settings</a>\r" +
    "\n" +
    "                </li>\r" +
    "\n" +
    "                <li class=\"divider\"></li>\r" +
    "\n" +
    "                <li>\r" +
    "\n" +
    "                    <a href=\"#\"><i class=\"fa fa-fw fa-power-off\"></i> Log Out</a>\r" +
    "\n" +
    "                </li>\r" +
    "\n" +
    "            </ul>\r" +
    "\n" +
    "        </li>\r" +
    "\n" +
    "    </ul>--><!-- Sidebar Menu Items - These collapse to the responsive navigation menu on small screens --><div class=\"navbar-collapse collapse in\" uib-collapse=\"vm.navCollapse\"><ul class=\"nav navbar-nav side-nav\"><li ng-class=\"{'active':vm.selectedSideMenu === 'dashboard'}\"><a ui-sref=\"main.dashboard\"><i class=\"fa fa-fw fa-dashboard\"></i> Dashboard</a></li><li ng-class=\"{'active':vm.selectedSideMenu === 'customers'}\"><a ui-sref=\"main.customers\"><i class=\"fa fa-fw fa-users\"></i> Customers</a></li><li ng-class=\"{'active':vm.selectedSideMenu === 'products'}\"><a ui-sref=\"main.products\"><i class=\"fa fa-fw fa-dashboard\"></i> Products</a></li><li ng-class=\"{'active':vm.selectedSideMenu === 'sales'}\"><a ui-sref=\"main.sales\"><i class=\"fa fa-fw fa-dashboard\"></i> Sales</a></li><li ng-class=\"{'active':vm.selectedSideMenu === 'purchases'}\"><a ui-sref=\"main.purchases\"><i class=\"fa fa-fw fa-dashboard\"></i> Purchases</a></li></ul></div></div>"
  );

}]);


angular.module('myShopApp').run(['$templateCache', function($templateCache) {
  'use strict';

  $templateCache.put('app/front-end/common/templates/error-messages.html',
    "<div><span class=\"text-danger\" ng-message=\"minlength\">Minmum allowed letters not entered</span> <span class=\"text-danger\" ng-message=\"maxlength\">Maximum allowed letters exceeded.</span> <span class=\"text-danger\" ng-message=\"required\">This field is required.</span></div>"
  );

}]);
